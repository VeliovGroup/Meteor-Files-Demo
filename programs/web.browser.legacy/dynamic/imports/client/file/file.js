function(e,t,i){var n,o,a,l,r,s;i.watch(e("meteor/http"),{HTTP:function(e){n=e}},0),i.watch(e("meteor/meteor"),{Meteor:function(e){o=e}},1),i.watch(e("meteor/templating"),{Template:function(e){a=e}},2),i.watch(e("meteor/reactive-var"),{ReactiveVar:function(e){l=e}},3),i.watch(e("/imports/lib/core.js"),{_app:function(e){r=e},Collections:function(e){s=e}},4),i.watch(e("./file.jade"));var c=!1,f=new l(!1),h=new l(!1),d=new l(!1),u=new l(!1),p=new l(!1),w=new l(!1);a.file.onRendered(function(){var e=this;if(w.set(!1),h.set(!1),this.data.file){if(this.data.file.isText||this.data.file.isJSON)this.data.file.size<65536?n.call("GET",this.data.file.link(),function(e,t){d.set(!0),e?console.error(e):~[500,404,400].indexOf(t.statusCode)||(t.content.length<65536?h.set(t.content):w.set(!0))}):w.set(!0);else if(this.data.file.isImage){var t=new Image,i;if(/png|jpe?g/i.test(this.data.file.type))t.onload=function(){d.set(!0)},t.onerror=function(){u.set(!0)},null!=this.data.file.versions&&null!=this.data.file.versions.preview&&this.data.file.versions.preview.extension?t.src=this.data.file.link("preview"):i=s.files.find(this.data.file._id).observeChanges({changed:function(n,o){null!=o&&null!=o.versions&&null!=o.versions.preview&&o.versions.preview.extension&&(t.src=e.data.file.link("preview"),i.stop())}});else t.onload=function(){f.set(!0)},t.onerror=function(){u.set(!0)},t.src=this.data.file.link()}else if(this.data.file.isVideo){var o=r.getElementFromView(this.view._domrange.parentElement,this.data.file._id);if(!o)return;if(o.canPlayType(this.data.file.type)){var a=o.play();("[object Promise]"===Object.prototype.toString.call(a)||"[object Object]"===Object.prototype.toString.call(a)&&a.then&&"[object Function]"===Object.prototype.toString.call(a.then))&&a.then(r.NOOP).catch(r.NOOP)}else u.set(!0)}else if(this.data.file.isAudio){var l=r.getElementFromView(this.view._domrange.parentElement,this.data.file._id);if(!l)return;if(l.canPlayType(this.data.file.type)){var c=l.play();("[object Promise]"===Object.prototype.toString.call(c)||"[object Object]"===Object.prototype.toString.call(c)&&c.then&&"[object Function]"===Object.prototype.toString.call(c.then))&&c.then(r.NOOP).catch(r.NOOP)}else u.set(!0)}window.IS_RENDERED=!0}else window.IS_RENDERED=!0}),a.file.helpers({warning:function(){return w.get()},getCode:function(){return this.type&&~this.type.indexOf("/")?this.type.split("/")[1]:""},isBlamed:function(){return!!~r.blamed.get().indexOf(this._id)},showInfo:function(){return p.get()},showError:function(){return u.get()},fetchedText:function(){return h.get()},showPreview:function(){return d.get()},showOriginal:function(){return f.get()}}),a.file.events({"click [data-blame]":function(e){e.preventDefault();var t=r.blamed.get();return~t.indexOf(this._id)?(t.splice(t.indexOf(this._id),1),r.blamed.set(t),o.call("unblame",this._id)):(t.push(this._id),r.blamed.set(t),o.call("blame",this._id)),!1},"click [data-show-info]":function(e){return e.preventDefault(),p.set(!p.get()),!1},"touchmove .file-overlay":function(e){return e.preventDefault(),!1},"touchmove .file":function(e,t){t.$(e.currentTarget).height()<t.$(".file-table").height()&&(t.$("a.show-info").hide(),t.$("h1.file-title").hide(),t.$("a.download-file").hide(),c&&o.clearTimeout(c),c=o.setTimeout(function(){t.$("a.show-info").show(),t.$("h1.file-title").show(),t.$("a.download-file").show()},768))}})}

